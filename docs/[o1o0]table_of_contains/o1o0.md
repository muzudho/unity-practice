Unity練習[O1o0]

| What is | This is                                |
| ------- | -------------------------------------- |
| OS      | Windows                                |
| Tool    | Unity Hub 3.3.0 （あとでインストール） |

# 手順

## Step [O1o0] インストールから

## Step [O1o1o0] インストール

👇 以下のホームページから、Unity をダウンロードしてほしい  

📖 [Unity](https://unity.com/ja)  

細かく言うと Unity Hub という名前の .exe ファイルかもしれない  

👇 インストール先の例  

`C:\Program Files\Unity Hub`  

Unity Hub というアプリケーションが Windows にインストールされたと思う  

英語版かと思うが、日本語化パッチのようなものは（あるのか知らないが）わたしは **当てない** 。  
英語の人口が 日本語の人口より多いのだから  
エラーメッセージが出たとき検索して情報が多いのは 英語版 であることが多い経験則から そうする  

## Step [O1o2o0] 実行

Unity Hub アプリケーションを実行してほしい  

プロジェクト一覧画面が出ているだろうか  
これで Unity は使える状態になった  

## Step [O1o3o0] 学習（しない）

Unity Hub のメニューから Learn を探してクリックしてほしい  
`Learn - Featured` が開いているだろう  

科目のようなものが並んでいて、どれを選べばいいか分からないかもしれない  

分からないときの最善の方法は　すべてのメニューをクリックして　開けてみればよい  

```plaintext
TIME TO COMPLETE:
XXX minutes
```

といった　完了するまでにかかる時間（分）が書いてあるだろう  

１時間は 60 minutes（分）だということを思い出してほしい  
たとえば `Beginner Course` は `2430 minutes` だから 40日と30分かかる  
これは大変だ、ということが分かったところで、いったん　着手せず、別の方法を探る  

## Step [O1o3o0] 学習 - 推奨（使わない）

`Unity Hub` の `Learn - Recommended` もクリックしてみよう  

`Sign in` というリンクをクリックしてほしい    

`Unity ID` というWebサイトに飛ばされる  
アカウントを作り、ここに Email と Password を入れる  

するとまた `Unity Hub` の `Learn - Recommended` に帰ってくる  

`Nothing here,yet` （まだ、ここには何もない）と書いてある  

## Step [O1o4o0] 学習（しない）

`Learn - Featured` に戻ってくる  

`TYPE` というものが薄い字で書かれてあり、その要素は以下のものがあるようだ  

* FOUNDATIONAL TUTORIAL （基礎チュートリアル）
* BEGINNER COURSE （初級コース）
* BEGINNER PROJECT （初級プロジェクト）
* INTERMEDIATE COURSE （中級コース）
* ADVANCED COURSE （上級コース）

基礎と初級はどっちを先にやればいいのか　なんの説明もないが、  

* `チュートリアル` というものは ちょっとした操作説明ぐらいで大したことはやらない雰囲気がある
* `コース` というものは そこに入ってしまうと長い雰囲気がある

とりあえず　手あたり次第　チュートリアルをクリックして開けて　説明だけ見ていってみる  

## Step [O2o0] Get started with the Unity Hub

`Get started with the Unity Hub` というフィーチャーが Foundational Tutorial で、 20 minutes のようだ  

とりあえず　これを実践してみよう  

`View on Unity Learn` をクリックする  

📖 [https://learn.unity.com/tutorial/get-started-with-the-unity-hub#](https://learn.unity.com/tutorial/get-started-with-the-unity-hub#)  

👆 Web サイトへ飛ばされる。 Web サイトを読みながらやれ、ということらしい  

じゃあ、やってみる  

英語だが、ブラウザの機能で日本語訳すれば問題ない  

どうも この `Get started with the Unity Hub` を読めるスキルレベルを習得すれば  
わたしが Qiita で記事を書かなくても良さそうな感じだ  

## Step [O3o0] Unity projects

Unity のプロジェクトを どのフォルダーの下に作るかだが、デフォルトだと  

`C:\Users\{ユーザー名}`  

の直下に作ってしまった。  
好きにすればいいが、わたしは次は  

`C:\Users\{ユーザー名}\Documents\UnityProjects`  

とでもフォルダーを切ってその下に置きなおした。やり方は以下の通り  

* Windows Explorer で 📂 `UnityProjects` を作成し、その下へ `Essentials 3D project` を移動
* Unity Hub のプロジェクト一覧から、 `Essentials 3D project` の行の […] ボタンをクリック、 `Remove project from list` をクリックして一覧から消す
* Unity Hub の `Open` ボタンで `Essentials 3D project` を選び直す


## Step [O4o0] Explore the Unity Editor

👇 次は `Explore the Unity Editor` というフィーチャーを開けてみる。 Foundational Tutorial で、 10 minutes のようだ  

📖 [https://learn.unity.com/tutorial/explore-the-unity-editor-1](https://learn.unity.com/tutorial/explore-the-unity-editor-1)  

画面の見方、カメラの操作の仕方などが学べた  

## Step [O5o0] Create with Code

`Learn - Featured` に戻ってくる  

`Create with Code` を開く。 Beginner Course で 2430 minutes だ。  
期間が長いが、ちょっと　かじってみて　嫌なら止めればいい。開けてみる  

📖 [https://learn.unity.com/course/create-with-code](https://learn.unity.com/course/create-with-code)  

いくつものパートに分かれているようだ  

チュートリアルのWebサイトを見渡すと、  
`Select your Unity version` というドロップダウンリストがある。  
インストールしている Unity のバージョンに合わせる。  
わたしは 2022年11月現在、 先行版の 2022.1 ではなく、 LTS の 2021.3 をインストールしているから、 2021.3 にする  

2021.3 は 2021年3月 に見えるから 2021c にでもすればいいのに、LTS は 3 だから 2021.3 だ、という表記は Unityの作法として決まっている。  

参考： 📖 [3.Identify Unity versions](https://learn.unity.com/tutorial/get-started-with-the-unity-hub#6126686cedbc2a6a469b37f8)  

私は神ではないので仕方ない。人のやることを受け入れることにする。諦め、妥協し、不本意なことに従う  

あとで分かったのだが この `Select your Unity version`、 記事毎に設定するもので、記事が存在しないバージョン番号もあるようだ。  
多分、古い記事の内容と同じで、変更がなかったのだと思うことにしよう。 ユーザーからすれば「記事が無い！」という気持ちだが、まあ、いいだろう  

## Step [O5o1o0] Getting Started

* `Getting Started` - Tutorial, Begginer, 35 Mins

さらにパートに分かれている  

### Step [O5o1o1o0] Course Introduction

* `Course Introduction` - Tutorial, Begginer, 10 Mins

動画が２本あり、やる気を高める動画と、このコースの動画を上手く使える人がしている勉強方法について　の２本のようだ  

Tips:  

動画は英語だし、字幕も　英語かスペイン語で 日本語はないかもしれない。  
じゃあ　日本語話者は　どうすればいいかというと、  
動画の外の下側に `Show transcript` リンクがあり　クリックすると 全文書き起こし のようなものが出てくるので  
Web ブラウザーの機能で Web サイト全体に Google翻訳 をかけるといいだろう  

例えば以下のように出る  

```quote
00:00:12  たった一つなのに
          ちょっとしたアドバイス

00:00:14  大事なことなのでここでシェアします

00:00:17  私たちがこのビデオ全体を作ったこと
          それについてあなたに話すために。

00:00:20  ですから、これ以上苦労することなく、

00:00:22  ここに最も重要な3つがあります
          あなたが知っておくべき言葉
```

あとで分かったことだが、日本語が選べる動画もあるし、選べない動画もあるようだ。まあ、いいだろう。  
また、ブラウザ翻訳すると、動画の上の字幕が日本語になるケースもあるし、ならないケースもある  

Tips:  

そんなことできないかも知れないが、教えておく  

もし 英語のリスニング（聞き取り）をしながら、動画と、日本語訳の間を目で往復するのが　間に合わないときは、  
動画を再生した直後に 一時停止し、  
日本語訳を先に全部読んでしまってから（変な直訳で意味分からないが）　落ち着いて 動画を見るとよい  

Tips:  

動画は、ページに埋め込まれているとサイズが小さくて　Unity Editor の文字が見えないので、全画面表示にして見るとよい  

### Step [O5o1o2o0] Install Unity Software

* `Install Unity Software` - Tutorial, Begginer, 25 Mins

インストールしておけ、というものが説明されている  

VS 2022 を使っているのに `Microsoft Visual Studio Community 2019` なんか入れたくないが、  
私は神ではないので仕方ない。人のやることを受け入れることにする。諦め、妥協し、不本意なことに従う  

ほとんど　先にやってしまっていたことが書いてある。先に進む  

Tips:  

あとで分かったことだが、外部スクリプトを開くエディターは選ぶことができる  

## Step [O5o2o_1o0] Unit 1 - Player Control

あとで分かったことだが、 Unit 1 の目次を見て　少なそうだな、と思ったら　目次を開けると中に　パートが沢山ある  

`Player Control` は、すぐにゲーム開発に取り掛かるのではなく、 Unity Editor の基本操作を覚えていく感じ  

## Step [O5o2o0] Unit 1 - Introduction

* `Unit 1 - Introduction` - Tutorial, Begginer, 5 Mins

確かに動画を１本見るだけで　５分もあれば終わる  

### Step [O5o2o1o0] Lesson 1.1 - Start your 3D Engines

* `Lesson 1.1 - Start your 3D Engines` - Tutorial, Begginer, 1 Hour 20 Mins

ここから実技に入るのだろう  

著作権で縛られていて商用不可の材料が .zip ファイルで置いてあるのでダウンロードする  
`Prototype 1 - Starter Files.zip` ファイルがダウンロードされた  

Tips:  

Unity Project の名前が `Prototype 1` なのだが、イケてないと思う。  
`Driving Car` みたいな名前なら　あとで思い出せると思うのだが、  
レッスンをしばらくサボって 続きをやるかな、と思ってプロジェクト・リストに `Prototype 1` という Unity Project が並んでいても  
「なんだったかな、これ……？」と思う  

じゃあ名前を変えればいいのかもしれないが、変えたら変えたで 後で分からなくなるのも嫌だ。  
私は神ではないので仕方ない。人のやることを受け入れることにする。諦め、妥協し、不本意なことに従う  

#### Step [O5o2o1o1o0] 1.Make a course folder and new project

動画ではデスクトップにフォルダーを置いていたが、  
わたしは フォルダーの場所を 📂 `"C:\Users\{ユーザー名}\UnityProjects\Create with Code"` とした。  

#### Step [O5o2o1o2o0] 2.Import assets and open Prototype 1

さっきダウンロードした `Prototype 1 - Starter Files.zip` ファイルをどこへでもいいので解凍する。  
`Prototype-1_Starter-Files.unitypackage` というファイルが出てくる。  
これは ユニティーパッケージ と呼ぶ  

ユニティーパッケージを Unity Editor へインポートする方法は　動画で説明があるので、そうする  

動画の中で同じことを２回やっているが、  
同じことは２回できないという説明なのに　２回できてしまい、よく分からないので無視した  

#### Step [O5o2o1o3o0] 3.Add your vehicle to the scene

とにかく　赤い車を置いた  

#### Step [O5o2o1o4o0] 4.Add an obstacle and reposition it

箱を置いたり、X,Y,Z 座標をリセットしたり、ゲームオブジェクトの名前を変えたりした  

#### Step [O5o2o1o5o0] 5.Locate your camera and run the game

カメラを選択する。プレイする  

#### Step [O5o2o1o6o0] 6.Move the camera behind the vehicle

* ギズモを使ってみる
* 車の後ろにカメラを持っていく
* マウスの左ボタンを押下しながら [Ctrl] キーをクリックすると何かできるそうだが、なんのことだか分からなかった

#### Step [O5o2o1o7o0] 7.Customize the interface layout

* Unity Editor の、いろんなレイアウトを試す
* `My Layout` を作ってほしい

### Step [O5o3o0] Lesson 1.2 - Pedal to the Metal

* `Lesson 1.2 - Pedal to the Metal` - Tutorial, Begginer, 1 Hour 10 Mins

* まず１本の動画を見る。スクリプトの話しをする、という前振りだ
    * これから PlayerControl というものを C#言語で作りますよ、という前振り

### Step [O5o3o1o0] 1.Create and apply your first script

* C#スクリプト・ファイルを新規作成して、 それを Vehicle（赤い車）にアタッチするところまで

### Step [O5o3o2o0] 2.Add a comment in the Update() method

* Unity の補助画面として Visual Studio を開いて C# スクリプトをここに書く……、というところまで
    * Tips として、 ソリューション・エクスプローラーといったサイドビューを全て閉じ、画面全体をテキストエディターだけにするのが見やすいというテクニックを教えてくれる

Tips  

📖 [Openin unity script in visual studio does not work](https://stackoverflow.com/questions/71812211/openin-unity-script-in-visual-studio-does-not-work#:~:text=Unity%20and%20VS%20versions%20do%20not%20match%2C%20try,and%20VS%20will%20automatically%20create%20it%20after%20deletion%29.)  

`[Edit] - [Preferences] - [External tools] - [External Script Editor]`

👆 エディターを選べるらしい  

`Visual Studio Community 2022` を選んだ  

Unity Editor で C# スクリプトファイルをダブルクリックすると、Visual Studio Community 2022 が出てきた  

VSCode も選べるが、 Visual Studio の方が インテリジェンス機能が利くので良かった  

### Step [O5o3o3o0] 3.Give the vehicle a forward motion

* トラックがすごいスピードで地平線まで走っていく

### Step [O5o3o4o0] 4.Use a Vector3 to move forward

* プログラムが数字で書かれているより、単語で書かれている方が見やすいよな、という話し
* z の正の数は　必ず前方なのだろうか。自分から見た座標か？
* z の単位は meter

### Step [O5o3o5o0] 5.Customize the vehicle’s speed

* トラックのスピードをゆっくりにする
* Frame （いわゆる FPS）を知る

### Step [O5o3o6o0] 6.Add RigidBody components to objects

* トラックと障害物が突き抜けないように、物理的な設定をする
* Mass の単位は killo-gram

### Step [O5o3o7o0] 7.Duplicate and position the obstacles

* 箱を増やす

### Step [O5o3o8o0] 8.Lesson Recap

* レッスン1.2のまとめ

### Step [O5o4o0] Lesson 1.3 - High Speed Chase

* `Lesson 1.3 - High Speed Chase` - Tutorial, Begginer, 50 Mins

* これからすることの説明動画を観る

### Step [O5o4o1o0] 1.Add a speed variable for your vehicle

* Unity Editor のインスペクターを使って、ゲーム画面を見ながら変数の値を変更する方法を知る

### Step [O5o4o2o0] 2.Create a new script for the camera

* トラックとカメラのポジションを紐づける方法を知る

### Step [O5o4o3o0] 3.Add an offset to the camera position

* 近すぎるトラックとカメラのポジションを少し離す方法を知る

### Step [O5o4o4o0] 4.Make the offset into a Vector3 variable

* コードの書き方を少し綺麗にする

### Step [O5o4o5o0] 5.Smooth the Camera with LateUpdate

* 画面のカクツキの解消

### Step [O5o4o6o0] 6.Edit the playmode tint color

* 再生中に、編集中と思って間違って編集するのを防ぐ方法

### Step [O5o4o7o0] 7.Lesson Recap

* まとめ動画を見る

### Step [O5o5o0] Lesson 1.4 - Step into the Driver's Seat

* `Lesson 1.4 - Step into the Driver's Seat` - Tutorial, Begginer, 50 Mins

* これからやることの動画を見る

### Step [O5o5o1o0] 1.Allow the vehicle to move left/right

* 左右への移動

### Step [O5o5o2o0] 2.Base left/right movement on input

* `Turn Speed` を 1 にするのを聞き逃さないでほしい
* `a`, `d` キーや、 左、右キーを使って　トラックを左右に移動できるようになる

### Step [O5o5o3o0] 3.Take control of the vehicle speed

* `w`, `s` キーや、上、下キーを使って　トラックを前後に移動できるようにする

### Step [O5o5o4o0] 4.Make vehicle rotate instead of slide

* `Global`、 `Local` ボタンの説明を聞いてやってみたが、 `Local` にしても `Global` と同じ動きだった。よく分からない
* トラックの首振り（Rotate）メソッドの説明
* `Speed` を 10、`Turn Speed` を 25 に変更

### Step [O5o5o5o0] 5.Clean your code and hierarchy

* ヒエラルキー・ウィンドウを整理する
* コードを整理する

### Step [O5o5o6o0] 6.Lesson Recap

* 今までの振り返り動画を見る

### Step [O5o6o0] Challenge 1 - Plane Programming

* `Challenge 1 - Plane Programming` - Tutorial, Begginer, 30 Mins

* 諦めるな、という感じの動画を見る

### Step [O5o6o1o0] 1.Challenge 1 Overview

* このチャレンジの全体像の説明動画を見る
    * バグがあるプロジェクトを修正するという内容
    * その答えは、そのチャレンジのページの下の方にあるから、分からなくなったときに見ろということ
    * それでも分からない場合の調べ方の紹介（Stack Overflow を見るとか、実際にプログラマーがやるような内容）
* `Prototype 1` に、 `Challenge 1` カスタムパッケージをインポートしてみたものの、そのあと何をするのか？
    * とりあえず `Instructions` フォルダーに入っている動画を見たところで、このステップを完了にする
    * `Scenes` という名前のフォルダーを作ってくれていないだけで、 `Challenge 1` というシーンが入っていたのでそれを開けてプレイする
        * 確かにバグがありそうだ。これを直すのがチャレンジらしい

### Step [O5o6o2o0] 2.Warning

* 説明が書いてある。バグを直せということと、分からなかったら下を読めということ
* 下にはヒントが書いてあるだけで答えは書いていないので、下を読まなくても、自分のやり方で、先々、勝手に直していいと思う
    * あとでヒントを読むと、自分のやり方が想定されていない方法だと分かったので直した

### Step [O5o6o3o0] 3.The plane is going backward

* 確かに　後ろに進むように書いてあるので、前に進むように書き直した

### Step [O5o6o4o0] 4.The plane is going too fast

* 飛行機が速く飛んでいるので、遅く飛ぶようにスピードを遅めにした（Speedを0.5にした）が、ヒントを見ると、わたしの方法は想定された解答ではないようだ

### Step [O5o6o5o0] 5.The plane is tilting automatically

* 飛行機が機首を上げたり、下げたりするのを勝手にやっているから、ユーザーが上、下キーを押したときだけ機首を上げ、下げするように  
  直せという課題だが、なぜ　機首が勝手に上がったり下がったりしてるのか分からない
    * プログラムに、機首を上げたり、下げたりしろと書いてあるのではないようだ
    * 発想の問題かと思う。一番シンプルだと思う方法で直した（飛行機のメッシュのチェックボックスを外した）が、ヒントを見ると、わたしの方法は想定された解答ではないようだ

### Step [O5o6o6o0] 6.The camera is in front of the plane

* カメラが　なんにもない方向を向いているので、飛行機の方を向くといいと思う
* この課題はもっと早いステップでやった方が、バグ探しが楽なんじゃないか？

### Step [O5o6o7o0] 7.The camera is not following the plane

* 飛行機は飛んでいくので、カメラが　飛行機と並走するように置くといいと思う

### Step [O5o6o8o0] 8.Bonus: The plane’s propeller does not spin

* 飛行機のプロペラが回っていないことを確認する
    * プロペラだけ部品が分かれているので、ヒエラルキー・ウィンドウから　プロペラをダブルクリックすると　再生中でもシーン・ビューで一瞬拡大できる
* インスペクターで設定できるのか、スクリプトを書くのか、どちらか分からない
* プロペラを１フレームに１回り　回すには　思ってるより大きな数字になることに気づくと　なんとかできた

### Step [O5o7o0] Lab 1 - Project Design Document

* `Lab 1 - Project Design Document` - Tutorial, Begginer, 1 Hour 30 Mins

やる気を出す動画を観る  

### Step [O5o7o1o0] 1.Understand what a Personal Project is

将来のレッスンでやることも含んだ、計画書の書き方の動画を観る

### Step [O5o7o2o0] 2.Review Design Doc examples

* 計画書の記入例の動画を観る
* Google Document 形式、Word 形式、 PDF 形式で 同じ計画書の テンプレートをダウンロードできる

### Step [O5o7o3o0] 3.Complete your Project Concept V1

* 計画書を観ながら、新しいプロジェクトを計画する例の動画を観る

### Step [O5o7o4o0] 4.Complete your Project Timeline

* タイムラインを書こう、という話しの動画を観る
* 追加したい機能は `Backlog` に書く

### Step [O5o7o5o0] 5.Complete your MVP sketch

* オフィスソフトを用いたアイデアスケッチの作り方動画を観る

### Step [O5o7o6o0] 6.Recap

* まとめ動画を観る

### Step [O5o8o0] Quiz 1

* `Quiz 1` - Quiz, Begginer, 15 Mins

クイズが１０問ある。ラジオボタンを選択していく  

### Step [O5o9o0] Bonus Features 1 - Share your Work

* `Bonus Features 1 - Share your Work` - Tutorial, Begginer, 1 Hour

### Step [O5o9o1o0] 1.Overview

動画を観る。  
難しいことをやらせるつもりで、このステップはスキップしてよいとの説明がある  

### Step [O5o9o2o0] 2.Easy: Obstacle pyramids

動画を観る。  
障害物を積んでみろ、ということらしい。  
あとで分かったことだが、ヒントは記事のページの下の方にある。とりあえず自分で調べてやる  

確かに、ブロックを積む方法が分からない。宙に浮く  

📖 [オブジェクトをきれいに配置する](https://unitygeek.hatenablog.com/entry/2016/10/28/142042)  

👆 `[Ctrl]` キーを押しながら　箱を動かしたりしてみるが、箱の表面に　スナップするようなことはなく　突き抜けたりする  

📖 [Unityショートカット : エディタ上でオブジェクトを密着させて配置する](https://indie-du.com/entry/2018/05/10/190000)  

👆 `[Shift] + [Ctrl]` キーを押しながら　箱を動かしたりしてみるが、スナップしている感じはしない。食い込む  
ただ、この操作が思っていることに一番近いから使う  

* Create Emptry で `Pile` と名前を付けて 箱を４つ入れ、 Pile を `[Ctrl] + [D]` で複製するなど 効率の良い作業方法を勝手にする

途中で飽きるので　完了　にする  

### Step [O5o9o3o0] 3.Medium: Oncoming vehicles

動画を観る。  
対向車を走らせてみろ、ということらしい。  
あとで分かったことだが、ヒントは記事のページの下の方にある。とりあえず自分で調べてやる  

とりあえず　白いバスを置いてみるが、反対を向かせる方法が分からん。Y軸を固定して、回転すればいいのか。できた  

走らせるには、スクリプトを新規作成して ゲームオブジェクトにアタッチして、  
スクリプトの内容は Z軸の正の方向に進んでもらうようにすればいいと思う  

`BusController.cs` みたいなファイル名でいいか？  

📺 [やってみた](https://twitter.com/muzudho1/status/1593889488903712768?s=20&t=j91bpOFtMBzEgSIPOoUeBA)  

途中で飽きるので　完了　にする  

### Step [O5o9o4o0] 4.Hard: Camera switcher

動画を観る。  
キーボードのキーを押すと 運転席視点と、車の後ろからの視点を　切り替えろ、ということらしい。  
あとで分かったことだが、ヒントは記事のページの下の方にある。とりあえず自分で調べてやる  

とりあえず `[Edit] - [Project Settings...] - [Input Manager]` を見てみる  
`Jump` に `Space` キーが割り当てられているので、とりあえず　これを使ってみる  

`FollowPlayer.cs` というスクリプトは、車の後ろからの始点 を意味するので、  
これとは別に `PerspectiveOfDriversSeat.cs` というスクリプトを作ればいいのか？  
`Jump` キーを受け取るスクリプトは どのゲームオブジェクトだ？  

📖 [Switch between 2 cameras](https://forum.unity.com/threads/switch-between-2-cameras.36209/)  

👆 2008年頃のフォーラムらしく、リンク切れしていて リンク先の URLが業者に乗っ取られている  

Unity Hub から 現在のフォーラムへ移動  

📖 [https://forum.unity.com/](https://forum.unity.com/)  

👆 検索の性能が悪く、欲しい記事が見つからない  

チュートリアルの記事に　コメントがあるので　読んでみるが　ベスト・プラクティス　を感じない  

`Hierarchy` ビューの `Main Camera` に C# スクリプトを２つアタッチすることはできるようだ。  
`FollowPlayer.cs` と `PerspectiveOfDriversSeat.cs` の２つのスクリプトを持たせた。  
このスクリプトの違いは、 offset だけ  

```cs
    private Vector3 offset = new Vector3(0.5f, 2, 1.5f);
```

👆 この x, y, z の数字は シーン画面、ゲーム画面を見ながら手調整していく  

ゲーム中に Space キーを押すと、その２つのスクリプトのうち、片方のスクリプトだけが有効になるように  
交互に切り替わってくれればいいわけだが  

`CameraSwitcher` という C# スクリプト・ファイルを作るか  
そして `Main Camera` ゲームオブジェクトへアタッチする  

スペースキーを押したかどうかを、どうやって取得するか？  

👇 例えば、これでどうか？  

```cs
    // Update is called once per frame
    void Update()
    {
        var isPressSpaceKey = Input.GetKeyDown(KeyCode.Space);
    }
```

`Main Camera` にアタッチされているスクリプトの　活性／不活性　を切り替えたいが、  
`Main Camera` にどうアクセスし、  
`Main Camera` にアタッチされているスクリプトの　活性／不活性　にどうやってアクセスする？  

インターネットで適当にググることにする  

📖 [他のスクリプトの変数を取得する](https://futabazemi.net/unity/script_var)  

👇 こうすると、それっぽくなるが、思ってる感じとは違う。  
思ってるのと違っていれば手調整する、の繰り返し  

```cs
using System;
using UnityEngine;

public class CameraSwitcher : MonoBehaviour
{
    private int cameraView;

    // Start is called before the first frame update
    void Start()
    {
        
    }

    // Update is called once per frame
    void Update()
    {
        var isPressSpaceKey = Input.GetKeyDown(KeyCode.Space);

        if (isPressSpaceKey)
        {
            // 0 と 1 を ひっくり返す
            cameraView = 1 - cameraView;

            var followPlayer = this.GetComponent<FollowPlayer>();
            var perspectiveOfDriverSeat = this.GetComponent<PerspectiveOfDriversSeat>();

            switch (cameraView)
            {
                case 0:
                    followPlayer.enabled = false;
                    perspectiveOfDriverSeat.enabled = true;
                    break;

                case 1:
                    followPlayer.enabled = true;
                    perspectiveOfDriverSeat.enabled = false;
                    break;

                default:
                    throw new Exception($"Unexpected cameraView:{cameraView}");
            }
        }

    }
}
```

📺 [やってみた](https://twitter.com/muzudho1/status/1593907013162979328?s=20&t=abok3EOg_8Y7Gz62HHebcA)  

### Step [O5o9o5o0] 5.Expert: Local multiplayer

動画を観る。  
画面を２分割して、左画面と　右画面で　別のカメラにして、車の操作も 1P と 2P で分けろ、ということらしい。  
あとで分かったことだが、ヒントは記事のページの下の方にある。とりあえず自分で調べてやる  

ヒントによると、カメラには `Viewport Rect` というプロパティがあるそうだ。確かにある  

じゃあ　とりあえず　２台目の　カメラを　置いてみるか  
`Main Camera` を `[Ctrl] + [D]` キーで複製する。 `2P Camera` に名称変更  

`Vehicle` も `[Ctrl] + [D]` キーで複製する。 `2P Vehicle` に名称変更  

`2P Camera` の `FollowPlayer` スクリプトの Player プロパティと、  
`PerspectiveOfDriversSeat` スクリプトの Player プロパティに `Vehicle` が入っているので、  
これを `2P Vehicle` に置き換える  

`Main Camera` の `Viewport Rect` の `X 0 Y 0 W 1 H 1` を、 `X 0 Y 0 W 0.5 H 1` に置き換える  
`2P Camera` の `Viewport Rect` の `X 0 Y 0 W 1 H 1` を、 `X 0.5 Y 0 W 0.5 H 1` に置き換える  

カメラや 車の位置を シーン画面で調整する  

`PlayerController.cs` が 1P のキー設定になっている。  
これを `[Ctrl] + [D]` キーで複製して `Player2Controller.cs` に名称変更する。
ファイルを開くと クラス名が `PlayerController` なので、 `Player2Controller` に変える  
`Player2Controller.cs` を `2P Vehicle` にアタッチする。  
もともと付いていた `PlayerController.cs` はリムーブする  

```cs
        horizontalInput = Input.GetAxis("Horizontal");
        forwardInput = Input.GetAxis("Vertical");
```

👆 この "Horizontal" などの名称を変える必要があると思う。 `Input Manager` を調べてみる  
プレイヤー１と プレイヤー２で 名称が分かれているわけでも無さそうだ  

📖 [Unityでオフラインの対戦プレイや協力プレイを実現する方法](https://gametukurikata.com/program/offlinecompetition)  

👆 自分で `Horizontal2` のように名前を変えなければいけないみたいだ、最初から設定しておいてくれたらいいのに……  
`Joy Num` というのが プレイヤー番号に相当するのだろう  

`Negative Button` などの設定を１つ１つ変えていく  
`Gravity` とか `Dead` とか何だか分からないが　1プレイヤーと 2プレイヤーで 同じになるように設定を変えていく  
最初の設定から　けっこう変えないといけない  

📺 [やってみた](https://twitter.com/muzudho1/status/1593940500779671553?s=20&t=VVtGTtwgf6GfmJ65Gx7RzA)  

### Step [O5o9o6o0] Share your work

画像をアップロードするといいらしいが、よく分からない  
スクリーンショットを撮ってアップロードする  

`Submission Gallery` というところに公開されるようだ  

## Step [O6o0] Unit 2 - Introduction

* `Unit 2 - Introduction` - Tutorial, Begginer, 5 Mins

📖 [Unit 2 - Introduction](https://learn.unity.com/tutorial/unit-2-introduction?uv=2020.3&courseId=5cf96c41edbc2a2ca6e8810f&projectId=5cdcc312edbc2a24a41671e6)  

案内役の人のテンションが上がっている動画を見る。  
英語のちからがないので　直訳を読むが、　その言い回しで　何を伝えようとしているのか　よく分からないが　まあいいだろう  

### Step [O6o1o0] Lesson 2.1 - Player Positioning

* `Lesson 2.1 - Player Positioning` - Tutorial, Begginer, 1 Hour

動画を観る。 if文の話しに触れてくれる  

### Step [O6o1o1o0] 1.Create a new Project for Prototype 2

動画を観る  

Unity Hub を使って `Prototype 2` プロジェクトを新規作成し、  
`.unitypackage` をプロジェクトにインポートする  

`SampleScene` は削除する  
`Prototype 2` シーンを開く  

### Step [O6o1o2o0] 2.Add the Player, Animals, and Food

動画を観る  

* キャラクターを配置する
* 牧場の娘のゲームオブジェクト名を `Player` に名称変更する

### Step [O6o1o3o0] 3.Get the user’s horizontal input

動画を観る  

* `Assets` フォルダーの下に `Scripts` フォルダーを作成する
* `Assets/Scripts` フォルダーの下に `PlayerController.cs` ファイルを作成する
* 水平方向の入力を変数に受け取るだけ

以下略

### Step [O6o1o4o0] 4.Move the player left-to-right

動画を観る。  
内容の趣旨は　プロトタイプ１　と被る  

* キー入力を、プレイヤーの水平位置に連動させる

### Step [O6o1o5o0] 5.Keep the player inbounds

動画を観る。  
C# を初めて書く人に向けての動画なので、コードをコピペするだけでもいいが、一応観ていく  

### Step [O6o1o6o0] 6.Clean up your code and variables

動画を観る。  
C# を初めて書く人に向けての動画なので、コードをコピペするだけでもいいが、一応観ていく  

### Step [O6o1o7o0] 7.Lesson Recap

まとめ動画を観るだけ  

### Step [O6o2o0] Lesson 2.2 - Food Flight

* `Lesson 2.2 - Food Flight` - Tutorial, Begginer, 1 Hour 10 Mins

動画を観るだけ  

* Prefabs の説明

#### Step [O6o2o1o0] 1.Make the projectile fly forwards

動画を観るだけ  

* 既知の技術の反復練習

#### Step [O6o2o2o0] 2.Make the projectile into a prefab

動画を観る  

* Prefabs の使い方の実践
  * プレファブを、C#スクリプトから参照できるようにする

#### Step [O6o2o3o0] 3.Test for spacebar press

動画を観る  

* スペースバーを押下されたことを C#スクリプトで判定する if文コードブロックを書くところまで

#### Step [O6o2o4o0] 4.Launch projectile on spacebar press

動画を観る  

* Instantiate の説明
    * 1行書くだけ

📺 [やってみた](https://twitter.com/muzudho1/status/1597540779119251458?s=20&t=97_u8Si1i6YPVMInTV241w)  

#### Step [O6o2o5o0] 5.Make animals into prefabs

動画を観る  

* 動物もプレファブにする

#### Step [O6o2o6o0] 6.Destroy projectiles offscreen

動画を観る  

* 画面外に飛んでいったピザを削除する方法の説明（画面外に出ていった動物はまだ削除しない）
* Prefabs を Override するのが要点
    * Hierarchy ビューのゲームオブジェクトにスクリプトをアタッチしても、プレファブには反映されない
        * Inspecter ビューの右上の `Overrides` ドロップダウンリストをクリックして、その中の `Apply All` ボタンをクリックすると、プレファブに反映されると説明される

#### Step [O6o2o7o0] 7.Destroy animals offscreen

動画を観る  

* 画面外に出ていった動物を削除する方法の説明
* if ～ else 文の説明

#### Step [O6o2o8o0] 8.Lesson Recap

動画を観る  

### Step [O6o3o0] Lesson 2.3 - Random Animal Stampede

* `Lesson 2.3 - Random Animal Stampede` - Tutorial, Begginer, 1 Hour

動画を観る  

* Ramdomness

#### Step [O6o3o1o0] 1.Create a spawn manager

動画を観る  

* Unity Editor で可変サイズの配列のプロパティを置く方法の説明

#### Step [O6o3o2o0] 2.Spawn an animal if S is pressed

動画を観る  

* Sキーを押すと　動物が発射される方法の説明

#### Step [O6o3o3o0] 3.Spawn random animals from array

動画を観る  

* 乱数の説明

#### Step [O6o3o4o0] 4.Randomize the spawn location

動画を観る  

* 乱数の説明（動物を生成する線上の点）

#### Step [O6o3o5o0] 5.Change the perspective of the camera

動画を観る  

* プロパティ１個分の説明
    * パースを付ける方法、パースを付けない方法の説明

#### Step [O6o3o6o0] 6.Lesson Recap

動画を観るだけ  

### Step [O6o4o0] Lesson 2.4 - Collision Decisions

* `Lesson 2.4 - Collision Decisions` - Tutorial, Begginer, 50 Mins

動画を観る  

* 関数を初めて自分で書くという話し

#### Step [O6o4o1o0] 1.Make a new method to spawn animals

動画を観る  

* 関数を始めて自分で書くという話し
    * リファクタリングするだけ

#### Step [O6o4o2o0] 2.Spawn the animals at timed intervals

動画を観る  

* `InvokeRepeating()` を使う
    * タイマーを１行で書ける

📺 [やってみた](https://twitter.com/muzudho1/status/1598890946871296003?s=20&t=YakPJiGGIrleJqGCLG75Aw)  

#### Step [O6o4o3o0] 3.Add collider and trigger components

動画を観る  

* `コライダー` の説明
* `RigidBody` と `Gravity` の説明
* Inspecter ビューの `Overrides` ドロップダウンリストの `Apply All` ボタンも必要なら使う

#### Step [O6o4o4o0] 4.Destroy objects on collision

動画を観る  

* `OnTriggerEnter` メソッドのオーバーライドの説明
* きつねから　止まっているピザに当たりに来ても　衝突とは判定されない？
* 動いているピザが　きつねに当たると　衝突と判定される？

#### Step [O6o4o5o0] 5.Trigger a “Game Over” message

動画を観る  

* `Debug.Log()` の説明
    * Unity のステータスバーは暗くて文字が見えない（文字の色ではなく、ログが非表示になっている）
        * `[Window] - [General] - [Console]` からコンソール・ウィンドウを表示できるが、デバッグ・ログは出ていない
            * コンソールの右上の [吹き出しに？が描かれたアイコン] をクリックすると ログが表示された。分かりづらい
                * ステータスバーにも文字が表示されるようになった
* シーンビューから　ピザと動物を消す
* ソースコードの自動フォーマットの説明

#### Step [O6o4o6o0] 6.Lesson Recap

動画を観るだけ  

### Step [O6o5o0] Challenge 2 - Play Fetch

📅 2022-12-03  

* `Challenge 2 - Play Fetch` - Tutorial, Begginer, 1 Hour

* バグのあるプログラムを直していこう、というもの

#### Step [O6o5o1o0] 1.Overview

動画を観る  

* `Challenge 2 - Starter Files.zip` をダウンロードして解凍する。 `Prototype-2_Starter-Files.unitypackage` が入っている
* `Prototype 2` プロジェクトに、 `Prototype-2_Starter-Files.unitypackage` パッケージをインポートする

Project ビュー:  

```plaintext
    📂 Assets
    └── 📂 Challenge 2
        ├── 📂 Instructions
        │    └── 📺 Challenge 2 - Outcome       # 完成形の動画
        └── 📄 Challenge 2                      # シーン
```

👆 インポートされる

`Challenge 2` シーンをクリックする  

`Challenge 2 - Outcome` 動画をクリックして動画を観る

#### Step [O6o5o2o0] 2.Warning

このチャレンジの説明  

* 以下のステップを続けて読んでいく

#### Step [O6o5o3o0] 3.Dogs are spawning at the top of the screen

画面の上で　犬が生成されているので、これをボールに変えること  

#### Step [O6o5o4o0] 4.The player is spawning green balls instead of dogs

スペースキーを押すと　農夫が緑色のボールをスポーンしている。  
代わりに　犬を生成するように変えること  

#### Step [O6o5o5o0] 5.The balls are destroyed if anywhere near the dog

犬の近くでないのに、ボールが破棄されている。  
代わりに、犬にぶつかったときにボールが破棄されているように見えてほしい  

#### Step [O6o5o6o0] 6.Nothing is being destroyed off screen

生成されたボールと犬が破棄されていないので、  
ボールは画面下に出たとき破棄してほしいし、犬は画面左の外に出たとき破棄してほしい  

#### Step [O6o5o7o0] 7.Only one type of ball is being spawned

ボールが１種類しか落ちてこないおんで、  
ボールが３種類落ちてくるようにしてほしい  

#### Step [O6o5o8o0] 8.Bonus: The spawn interval is always the same

ボールが等間隔の時間で落ちてきているので、  
3～5秒の間隔でランダムに落ちてきてほしい  

#### Step [O6o5o9o0] 9.Bonus: The player can “spam” the spacebar key

犬を連射できるので、  
連射の間隔を一定時間 開けてほしい  

👇 こうやった  

PlayerControllerX.cs:  

```csharp
using UnityEngine;

public class PlayerControllerX : MonoBehaviour
{
    public GameObject dogPrefab;

    /// <summary>
    /// 溜め時間
    /// </summary>
    private float chargeSecs = 1.0f;

    /// <summary>
    /// 経過時間
    /// </summary>
    private float elapsedSecs = float.MaxValue;

    // Update is called once per frame
    void Update()
    {
        elapsedSecs += Time.deltaTime;

        // On spacebar press, send dog
        if (Input.GetKeyDown(KeyCode.Space) && elapsedSecs > chargeSecs)
        {
            Instantiate(dogPrefab, transform.position, dogPrefab.transform.rotation);
            elapsedSecs = 0.0f;
        }
    }
}
```

### Step [O6o6o0] Lab 2 - New Project with Primitives

📅 2022-12-03 sat 16:21  

* `Lab 2 - New Project with Primitives` - Tutorial, Begginer, 1 Hour

`プリミティブ` は、球体、立方体、平面 のような基本図形のこと 

できあいのものをインポートせず、新規作成のプロジェクトから、作っていくという趣旨  

動画を観る  

#### Step [O6o6o1o0] 1.Create a new Project and rename your scene

動画を観る  

* `Personal Project` を作る

#### Step [O6o6o2o0] 2.Create a background plane

動画を観る  

* 背景、または床を置こう　という話し
* Plane オブジェクトの Inspector ビューの Transform コンポーネントの `Reset` ボタンを押そう、という話し

#### Step [O6o6o3o0] 3.Create primitive Player with a new material

動画を観る  

* 球体を シーン ビューに置く。名前は `Player`

Project ビュー:  

```plaintext
    📂 Assets
👉  └── 📂 Materials    # 新規作成
👉      └── 📄 Blue     # 新規作成
```

* 青いマテリアルを作って、シーン ビューに置いてある球体にドラッグ＆ドロップする

#### Step [O6o6o4o0] 4.Position camera based on project type

動画を観る  

* カメラのポジションを決めよう、という話し

#### Step [O6o6o5o0] 5.Enemies, obstacles, projectiles & materials

動画を観る  

* 敵、障害物　等の配置
* 着色

#### Step [O6o6o6o0] 6.Export a Unity Package backup file

動画を観る  

* バックアップの取り方の説明
    * `*.unitypackage` ファイルを作れる

```plaintext
    📂 UnityProjects    # 練習用フォルダー
👉  └── 📂 Backups      # 新規作成
```

#### Step [O6o6o7o0] 7.Lesson Recap

動画を観るだけ  

### Step [O6o7o0] Quiz 2

* `Quiz 2` - Quiz, Begginer, 15 Mins

概要は文章が長くて堅苦しいし、読み飛ばしていいかも。  

### Step [O6o8o0] Bonus Features 2 - Share your Work

* `Bonus Features 2 - Share your Work` - Tutorial, Begginer, 1 Hour

#### Step [O6o8o1o0] 1.Overview

４つの難易度別の努力目標が与えられる  

完成図の動画を観る  

* 以下のステップを続けて読んでいく

#### Step [O6o8o2o0] 2.Easy: Vertical player movement

動画を観る  

* プレイヤーを上下に動かせるようにする

#### Step [O6o8o3o0] 3.Medium: Aggressive animals

動画を観る  

* 動物を左右から出すようにする
* 左右から出てきた動物に当たると、コンソールにゲームオーバーと表示する

* プレイヤーに `BoxCollider` を付けると、ピザを発射した瞬間にプレイヤーが消えてしまう。また、動物が、動物に当たって消えてしまう
    * `レイヤー` という概念が必要
        * `Player` の Inspector の上の方の `Layer` ドロップダウンリストの `Add Layer` をクリック
            * 例えば `User Layer 10` に `Player` と入力
            * `User Layer 11` に `Animal` と入力
            * `User Layer 12` に `Projectile` （発射物）と入力
        * `Player` ゲームオブジェクトの `Layer` ドロップダウンリストを `Player` レイヤーに変更
        * 各動物ゲームオブジェクトの `Layer` ドロップダウンリストを `Animal` レイヤーに変更
        * ピザの `Layer` ドロップダウンリストを `Projectile` レイヤーに変更
        * `[Edit] - [Project Settings] - [Physics] -[Layer Collision Matrix]`
            * `Player` と `Animal` のチェックがオンである
            * `Player` と `Projectile` のチェックをオフにする
            * `Animal` と `Animal` のチェックをオフにする
    * ピザを参考に、プレイヤー、動物にも `RigidBody` を追加。 `Use Gravity` のチェックは外す

DetectCollisions.cs:  

```csharp
using UnityEngine;

/// <summary>
/// 衝突の検出
/// </summary>
public class DetectCollisions : MonoBehaviour
{
    // Start is called before the first frame update
    void Start()
    {
        
    }

    // Update is called once per frame
    void Update()
    {
        
    }

    /// <summary>
    /// 自分: 動物
    /// </summary>
    /// <param name="other">農夫、動物</param>
    private void OnTriggerEnter(Collider other)
    {
        if (gameObject.name == "Player")
        {
            Debug.Log("Damage! Game Over!");
        }

        // このスクリプトの所有者を破棄
        Destroy(gameObject);

        // このスクリプトの所有者と衝突した方を破棄
        Destroy(other.gameObject);
    }
}
```

PlayerController.cs:  

```csharp
using UnityEngine;

public class PlayerController : MonoBehaviour
{
    public float horizontalInput;
    public float verticalInput;
    public float speed = 10.0f;
    public float xRange = 10;

    /// <summary>
    /// 発射するもの
    /// </summary>
    public GameObject projectilePrefab;

    // Start is called before the first frame update
    void Start()
    {
        
    }

    // Update is called once per frame
    void Update()
    {
        // Keep the player in bounds
        if (transform.position.x < -xRange)
        {
            transform.position = new Vector3(-xRange, transform.position.y, transform.position.z);
        }
        if (transform.position.x > xRange)
        {
            transform.position = new Vector3(xRange, transform.position.y, transform.position.z);
        }

        horizontalInput = Input.GetAxis("Horizontal");
        transform.Translate(Vector3.right * horizontalInput * Time.deltaTime * speed);

        verticalInput = Input.GetAxis("Vertical");
        transform.Translate(Vector3.forward * verticalInput * Time.deltaTime * speed);

        // Launch a projectile from the player
        if (Input.GetKeyDown(KeyCode.Space))
        {
            Instantiate(projectilePrefab, transform.position, projectilePrefab.transform.rotation);
        }
    }
}
```

#### Step [O6o8o4o0] 4.Hard: Game user interface

動画を観る  

やりたいことは次の通り  

プレイヤーに `Lives` というプロパティーを持たせ、 3 から開始し、 0 になると ログに `Game Over` と出す。  
動物とプレイヤーが衝突すると Lives が 1 減る。  
`Score` というプロパティーがあり、 0 から開始し、 ピザと動物が衝突すると 1 増える。  
`Lives` と `Score` は コンソールに表示する  

プレイヤーに `Lives` や `Score` を持たせると、プレイヤーを破棄したときに `Lives` と `Score` も画面から消えてしまう。  
とりあえず `GameManager` ゲームオブジェクトを新規作成して、 `GameManager` C#スクリプトをアタッチすることにする  

```csharp
using UnityEngine;

public class GameManager : MonoBehaviour
{
    public int lives = 3;
    public int score = 0;

    // Start is called before the first frame update
    void Start()
    {
        
    }

    // Update is called once per frame
    void Update()
    {
        
    }
}
```

`Lives` と `Score` が変化するタイミング、 `Game Over` と表示するタイミングを以下にリストする  

* 動物とプレイヤーが衝突したとき
* ピザと動物が衝突したとき
* `Score` が 0 になったタイミング

👇 とりあえず `Lives` を 1 減らすメソッドと、 `Lives` が 0 になったときに `Game Over` を表示するコードを `GameManager.cs` に追加する。  
   ついでに `Score` を 1 増やすメソッドも追加する  

```csharp
    /// <summary>
    /// ライフを１減らす
    /// </summary>
    public void DecreaseLive()
    {
        if (0 < lives)
        {
            lives--;
            Debug.Log($"Lives:{lives}");

            if (lives == 0)
            {
                Debug.Log("Game Over");
            }
        }
    }

    /// <summary>
    /// スコアを１増やす
    /// </summary>
    public void IncreaseLive()
    {
        score++;
        Debug.Log($"Score:{score}");
    }
```

👇 `DetectCollisions.cs` の `OnTriggerEnter` を書きかえる  

```csharp
    /// <summary>
    /// 
    /// </summary>
    /// <param name="other"></param>
    private void OnTriggerEnter(Collider other)
    {
        // レイヤー名を取得
        var myLayerName = LayerMask.LayerToName(gameObject.layer);
        var opponentLayerName = LayerMask.LayerToName(other.gameObject.layer);
        // Debug.Log($"myLayerName:{myLayerName} opponentLayerName:{opponentLayerName}");

        // プレイヤーが、動物に衝突したとき
        if (myLayerName == "Player" && opponentLayerName == "Animal")
        {
            var gameManagerScript = GameObject.Find("GameManager").GetComponent<GameManager>();

            // ライフを減らす
            gameManagerScript.DecreaseLive();

            if (gameManagerScript.lives < 1)
            {
                // プレイヤーを破棄
                Destroy(gameObject);
            }
        }

        // 発射物が、動物に衝突したとき
        if (myLayerName == "Projectile" && opponentLayerName == "Animal")
        {
            var gameManagerScript = GameObject.Find("GameManager").GetComponent<GameManager>();

            // スコアを増やす
            gameManagerScript.IncreaseLive();
        }

        // このスクリプトの所有者を破棄（プレイヤーを除く）
        if (myLayerName != "Player")
        {
            Destroy(gameObject);
        }

        // 衝突した相手の方を破棄（プレイヤーを除く）
        if (opponentLayerName != "Player")
        {
            Destroy(other.gameObject);
        }
    }
```

#### Step [O6o8o5o0] 5.Expert: Animal hunger bar

動画を観る  

* 大きな改造になるので、改造に取り掛かる前に Export Package で **バックアップを残した方がよい**  

やりたいことは次の通り  

各動物の上に [空腹バー] を表示する。  
[空腹バー] は最初空っぽで、ピザを当てるごとに増えていく。 [空腹バー] が満たされると動物は破棄される。  
動物の種類ごとに、ピザを何回当てればいいか異なる  

思ったのは次の通り  

GUI を作るのは スキルレベル が高すぎる。平面図形を使った簡単なものでいいか。  
黒い平面と、緑色の平面を２枚重ねればいいのでは。  
緑色の平面と、黒い平面の左側を揃えて、緑色の平面の横幅が　０～黒い平面の横幅　に伸びていくと考える  

Scene ビュー:  

```plaintext
    📄 HungerBar            # GameObject
    ├── 📄 Plane_Green      # GameObject with Material
    └── 📄 Plane_Black      # GameObject with Material
```

この `HungerBar` ゲームオブジェクトを 動物の真上に くっつけるにはどうすればいいか？  
とりあえず、 `HunberBar` C#スクリプトを作って、 `HunberBar` ゲームオブジェクトにアタッチする  

次に、動物に 空腹 カウントを持たせることにする。  
動物は [空腹バー] を持っているのだから、空腹バーに 空腹カウントを持たせるのがよさそう。  
現在値の `value`、 最大値の `max` があればいいだろうか。  

空腹バーのためのコードを追加  

次に、ピザが動物に当たったときに、 満腹度を 1 増やしたい  

次に、緑色の平面の横幅を変更したい。  
どうやって　緑色の平面　を取得するのか？  
`HungerBar` ゲームオブジェクト の子要素の `Plane_Green` ゲームオブジェクトを取るには？  
ヒエラルキー・ビューのゲームオブジェクトを指すフルパスのようなものは無いらしい  

動物から、 [空腹バー] への紐づきが無いことに気づく。  
`Animal` C#スクリプトを作成し、 各動物にアタッチする  

コードは以下の通り  

Animal.cs:  

```csharp
using UnityEngine;

public class Animal : MonoBehaviour
{
    /// <summary>
    /// 空腹バー
    /// </summary>
    public GameObject hungerBarPrefab;

    // Start is called before the first frame update
    void Start()
    {
        
    }

    // Update is called once per frame
    void Update()
    {
        
    }
}
```

SpawnManager.cs / SpawnRandomAnimal method:  

```csharp
    public GameObject hungerBarPrefab;
    private float spawnRangeZ = 10;
    private float spawnPosX = 30;

    void SpawnRandomAnimal()
    {
        // 進行方向
        // -1: to right
        // 0: to down
        // 1: to left
        var angleType = Random.Range(-1, 2);

        // Randomly generate animal index and spawn position
        Vector3 spawnPos;

        if (angleType == 0)
        {
            spawnPos = new Vector3(Random.Range(-spawnRangeX, spawnRangeX), 0, spawnPosZ);
        }
        else if (angleType == 1)
        {
            spawnPos = new Vector3(spawnPosX, 0, Random.Range(-spawnRangeZ, spawnRangeZ));
        }
        else
        {
            spawnPos = new Vector3(-spawnPosX, 0, Random.Range(-spawnRangeZ, spawnRangeZ));
        }

        // 動物
        int animalIndex = Random.Range(0, animalPrefabs.Length);
        var animal = Instantiate(animalPrefabs[animalIndex], spawnPos, animalPrefabs[animalIndex].transform.rotation);
        animal.transform.Rotate(Vector3.up, (angleType * 90.0f + 360.0f) % 360.0f);// 向きを変える
        var animalScript = animal.GetComponent<Animal>();

        // 空腹バー
        var hungerBar = Instantiate(hungerBarPrefab, spawnPos, new Quaternion(0.0f, 0.0f, 0.0f, 0.0f));
        var hungerBarScript = hungerBar.GetComponent<HungerBar>();

        // 動物の種類に応じて、空腹バーの最大値を変更する
        if (animal.name == "Animal_Fox_01(Clone)")
        {
            hungerBarScript.max = 1;
        }
        else if (animal.name == "Animal_Doe_01(Clone)")
        {
            hungerBarScript.max = 2;
        }
        else if (animal.name == "Animal_Moose_01(Clone)")
        {
            hungerBarScript.max = 3;
        }

        // 動物と空腹バーを相互紐づけ
        hungerBarScript.precededPrefab = animal;
        animalScript.hungerBarPrefab = hungerBar;
    }
```

DetectCollisions.cs / OnTrigger method:  

```csharp
    private void OnTriggerEnter(Collider other)
    {
        bool isDestroySelf = false;
        bool isDestroyOpponent = false;

        // レイヤー名を取得
        var myLayerName = LayerMask.LayerToName(gameObject.layer);
        var opponentLayerName = LayerMask.LayerToName(other.gameObject.layer);
        // Debug.Log($"myLayerName:{myLayerName} opponentLayerName:{opponentLayerName}");

        // プレイヤーが、動物に衝突したとき
        if (myLayerName == "Player" && opponentLayerName == "Animal")
        {
            var gameManagerScript = GameObject.Find("GameManager").GetComponent<GameManager>();

            // ライフを減らす
            gameManagerScript.DecreaseLive();

            if (gameManagerScript.lives < 1)
            {
                // プレイヤーを破棄
                Debug.Log($"Destroy player. Life none.");
                isDestroySelf = true;
            }
        }

        // 発射物が、動物に衝突したとき
        if (myLayerName == "Projectile" && opponentLayerName == "Animal")
        {
            // スコアを増やす
            var gameManagerScript = GameObject.Find("GameManager").GetComponent<GameManager>();
            gameManagerScript.IncreaseLive();

            // 動物から、空腹バーを取得
            var animalScript = other.gameObject.GetComponent<Animal>();
            var hungerBar = animalScript.hungerBarPrefab;
            var hungerBarScript = hungerBar.GetComponent<HungerBar>();

            // 満腹度を増やす
            hungerBarScript.IncreaseValue();

            // 満腹になっていれば、その動物オブジェクトと、空腹バーの両方を破棄
            if (hungerBarScript.IsFull())
            {
                Debug.Log($"Destroy animal. value:{hungerBarScript.value} max:{hungerBarScript.max}");
                isDestroyOpponent = true;
                Destroy(hungerBar);
            }

            // 発射物を破棄
            Debug.Log($"Destroy food. Because it hit an animal.");
            isDestroySelf = true;
        }

        // このスクリプトの所有者を破棄
        if (isDestroySelf)
        {
            Destroy(gameObject);
        }

        // 衝突した相手の方を破棄
        if (isDestroyOpponent)
        {
            Destroy(other.gameObject);
        }
    }
```

GameManager.cs:  

```csharp
using UnityEngine;

public class GameManager : MonoBehaviour
{
    public int lives = 3;
    public int score = 0;

    // Start is called before the first frame update
    void Start()
    {

    }

    // Update is called once per frame
    void Update()
    {

    }

    /// <summary>
    /// ライフを１減らす
    /// </summary>
    public void DecreaseLive()
    {
        if (0 < lives)
        {
            lives--;
            Debug.Log($"Lives:{lives}");

            if (lives == 0)
            {
                Debug.Log("Game Over");
            }
        }
    }

    /// <summary>
    /// スコアを１増やす
    /// </summary>
    public void IncreaseLive()
    {
        score++;
        Debug.Log($"Score:{score}");
    }
}
```

HungerBar.cs:  

```csharp
using UnityEngine;

/// <summary>
/// 空腹バー
/// 
/// - 満腹度
/// </summary>
public class HungerBar : MonoBehaviour
{
    /// <summary>
    /// 先行プレファブ
    /// 
    /// - 張り付き先のゲームオブジェクト
    /// </summary>
    public GameObject precededPrefab;

    /// <summary>
    /// 現在値
    /// </summary>
    public int value = 0;

    /// <summary>
    /// 最大値
    /// </summary>
    public int max = 1;

    // Start is called before the first frame update
    void Start()
    {
        // 緑色の平面の横幅を変更する
        this.Repaint();
    }

    // Update is called once per frame
    void Update()
    {
        // 先行プレファブと、位置を同じくします
        if (precededPrefab != null)
        {
            gameObject.transform.position = precededPrefab.transform.position;
        }
    }

    /// <summary>
    /// 満タンか？
    /// </summary>
    /// <returns></returns>
    public bool IsFull()
    {
        return max <= value;
    }

    /// <summary>
    /// 1 増やす
    /// </summary>
    public void IncreaseValue()
    {
        if (value < max)
        {
            value++;
            Debug.Log($"Nice taste! value:{value} max:{max}");
        }

        // 緑色の平面の横幅を変更する
        this.Repaint();
    }

    /// <summary>
    /// 緑色の平面の横幅を変更する
    /// </summary>
    private void Repaint()
    {
        if (precededPrefab != null)
        {
            var rate = (float)value / (float)max;

            var greenPlain = gameObject.transform.GetChild(0);
            greenPlain.transform.localScale = new Vector3(rate, greenPlain.transform.localScale.y, greenPlain.transform.localScale.z);
            // Debug.Log($"Repaint. greenPlain.name:{greenPlain.name} greenPlain.transform.localScale:{greenPlain.transform.localScale} rate:{rate} value:{value} max:{max}");
        }
        //else
        //{
        //    Debug.Log("[Error] Repaint failed. Because precededPrefab is null.");
        //}
    }
}
```

見栄えが悪いところはあるが、大変なので先に進むことにする  

#### Step [O6o8o6o0] 6.Hints and solution walkthrough

ヒントが書いてある  

#### Step [O6o8o7o0] Share your work

📅 2022-12-04 sun 18:30  

作品動画をアップロードすることができる  

📺 [やってみた](https://twitter.com/muzudho1/status/1599334789768974336?s=20&t=VVUq0Z47FX_oDGnZ8agtLQ)  

### Step [O6o9o0] Unit 3 - Introduction

* `Unit 3 - Introduction` - Tutorial, Begginer, 5 Min

📖 [Unit 3 - Sound and Effects](https://learn.unity.com/project/unit-3-sound-and-effects?uv=2020.3&courseId=5cf96c41edbc2a2ca6e8810f)  

#### Step [O6o9o1o0] 1.Unit 3 - Introduction

動画を観るだけ  

* おじさんがジョークを言うようになってきた
* BGM、効果音、パーティクルの前振り

#### Step [O6o9o2o0] Lesson 3.1 - Jump Force

📅 2022-12-04 sun 18:42  

* `Lesson 3.1 - Jump Force` - Tutorial, Begginer, 1 Hour 30 Mins

#### Step [O6o9o2o1o0] Overview Video

動画を観るだけ  

* 放物線を描くには `Translate()` では困難なので、Unity の物理演算 `AddForce()` を使おう、という話し

#### Step [O6o9o2o2o0] 1.Open prototype & change background

動画を観る  

* 新しいプロジェクト `Prototype 3` を作って、 `Prototype-3_Starter-Files.unitypackage` をインポートする
* `SpriteRenderer` の説明

#### Step [O6o9o2o3o0] 2.Choose and set up a player character

動画を観る  

* `Player` ゲームオブジェクトの準備

#### Step [O6o9o2o4o0] 3.Make player jump at start

動画を観る  

* `GetComponent<T>()` の使い方
* `RigidBody` の `AddForce()` の使い方

#### Step [O6o9o2o5o0] 4.Make player jump if spacebar pressed

動画を観る  

* スペース・バーを押下してジャンプする
* ジャンプの上昇をすぐにする `ForceMode.Impulse` 定数

#### Step [O6o9o2o6o0] 5.Tweak the jump force and gravity

動画を観る  

* `Physics.gravity` フィールドの説明
* `*=` 演算子の説明

#### Step [O6o9o2o7o0] 6.Prevent player from double-jumping

動画を観る  

* `bool` 型の説明
* `&&` 演算子の説明
* `OnCollisionEnter` メソッドの説明

#### Step [O6o9o2o8o0] 7.Make an obstacle and move it left

動画を観る  

* 画面を固定して、障害物や、背景の方を高速に移動させる説明

#### Step [O6o9o2o9o0] 8.Create a spawn manager

動画を観る  

* `SpawnManager` の作成

#### Step [O6o9o2o10o0] 9.Spawn obstacles at intervals

動画を観る  

* 障害物の生成をリピート
* 衝突時に物体が傾く軸方向のフリーズの説明

#### Step [O6o9o2o11o0] 10.Lesson Recap

📅 2022-12-04 sun 22:03  

動画を観るだけ  

📺 [やってみた](https://twitter.com/muzudho1/status/1599385553807417344?s=20&t=CQPmtaKX-z5f0JqAA0TIoA)  

### Step [O6o9o3o0] Lesson 3.2 - Make the World Whiz By

* `Lesson 3.2 - Make the World Whiz By` - Tutorial, Begginer, 1 Hour 10 Mins

#### Step [O6o9o3o1o0] Overview Video

動画を観るだけ  

* このレッスンでやる内容のあらすじ  

#### Step [O6o9o3o2o0] 1.Create a script to repeat background

動画を観る  

* 背景がスクロールしているように見える仕組みの説明
* `RepeatBackground` C#スクリプトを `Background` オブジェクト（背景）にアタッチ

#### Step [O6o9o3o3o0] 2.Reset position of background

動画を観る  

* 背景がリピートするスクリプトを書く

#### Step [O6o9o3o4o0] 3.Fix background repeat with collider

📅 2022-12-06 sun 19:42  

動画を観る  

* 背景の横幅を正確に計算する

#### Step [O6o9o3o5o0] 4.Add a new game over trigger

動画を観る  

* `Tag` の作り方、付け方
* 地面と、障害物を区別する
  * `CompareTag()`

#### Step [O6o9o3o6o0] 5.Stop MoveLeft on gameOver

動画を観る  

* スクリプトから、別のゲームオブジェクトにアタッチされているスクリプトの取得方法の説明

#### Step [O6o9o3o7o0] 6.Stop obstacle spawning on gameOver

動画を観る  

* 同様

#### Step [O6o9o3o8o0] 7.Destroy obstacles that exit bounds

動画を観る  

* 通り過ぎて行った障害物を削除する

📺 [やってみた](https://twitter.com/muzudho1/status/1600095447464706053?s=20&t=QEWv5pc1tm6ZK15fNhA5ww)  

#### Step [O6o9o3o9o0] 8.Lesson Recap

📅 2022-12-06 sun 20:56  

動画を観るだけ  

### Step [O6o9o4o0] Lesson 3.3 - Don't Just Stand There

📅 2022-12-07 sun 19:11  

* `Lesson 3.3 - Don't Just Stand There` - Tutorial, Begginer, 1 Hour

#### Step [O6o9o4o1o0] Overview Video

動画を見るだけ  

* `AnimationController` の前振り

#### Step [O6o9o4o2o0] 1.Explore the player’s animations

動画を見る  

* `Animatoion Controller` の説明
* いろいろダブルクリックして覗き見るだけ
    * `Player` ゲームオブジェクトの `Animator` コンポーネントの `Controller` 欄をダブルクリックする

#### Step [O6o9o4o3o0] 2.Make the player start off at a run

動画を見る  

* キャラクターが走るようになる
    * テキストボックスに、数値を入れる

📺 [やってみた](https://twitter.com/muzudho1/status/1600456720123240450?s=20&t=mvaFLmg0tTgAqC3N8O72tg)  

#### Step [O6o9o4o4o0] 3.Set up a jump animation

動画を見る  

* `PlayerController` C#スクリプトから、 `Player` ゲームオブジェクトの持つ `Animator` コンポーネントへアクセスする

#### Step [O6o9o4o5o0] 4.Adjust the jump animation

動画を見る  

* 空中を走るのを直す

#### Step [O6o9o4o6o0] 5.Set up a falling animation

動画を見る  

* スクリプトを書いて、倒れ込む演技へ、状態遷移

#### Step [O6o9o4o7o0] 6.Keep player from unconscious jumping

動画を見る  

* 倒れ込んだあとにまだジャンプできる不具合を修正する

#### Step [O6o9o4o8o0] 7.Lesson Recap

📅 2022-12-07 sun 21:48  

動画を見るだけ  

### Step [O6o9o5o0] Lesson 3.4 - Particles and Sound Effects

📅 2022-12-08 sun 19:21  

* `Lesson 3.4 - Particles and Sound Effects` - Tutorial, Begginer, 1 Hour

#### Step [O6o9o5o1o0] Overview Video

動画を見るだけ  

* `Particle` や、 `SoundListener` の説明

#### Step [O6o9o5o2o0] 1.Customize an explosion particle

動画を見る  

* `Player` ゲームオブジェクトへ、 パーティクルをアタッチする方法

#### Step [O6o9o5o3o0] 2.Play the particle on collision

動画を見る  

* パーティクルの再生方法
    * （プロジェクト ビューではなく）ヒエラルキー ビューの方のパーティクルを、 `PlayerController` C#スクリプトへアタッチする

#### Step [O6o9o5o4o0] 3.Add a dirt splatter particle

動画を見る  

* 足元のパーティクル
* ジャンプ中に障害物に当たると、足元のパーティクルは消えないようだ？

#### Step [O6o9o5o5o0] 4.Add music to the camera object

動画を見る  

* カメラは音楽を聴くための耳も兼ねている
* `AudioSource` の説明

#### Step [O6o9o5o6o0] 5.Declare variables for Audio Clips

動画を見る  

* 効果音を `PlayerController` C#スクリプトへアタッチする

#### Step [O6o9o5o7o0] 6.Play Audio Clips on jump and crash

動画を見る  

* 効果音を鳴らす

📺 [やってみた](https://twitter.com/muzudho1/status/1600836150440050689?s=20&t=feWaxn-WXBZIg5iPfkhVCA)  

#### Step [O6o9o5o8o0] 7.Lesson Recap

📅 2022-12-08 sun 22:05  

動画を見るだけ  

### Step [O6o9o6o0] Challenge 3 - Balloons, Bombs, & Booleans

📅 2022-12-10 sun 11:42  

* `Challenge 3 - Balloons, Bombs, & Booleans` - Tutorial, Begginer, 1 Hour

* エラーを直すというもの
* このチャレンジ３は、最初の動かない不具合を除けば、チャレンジ２より簡単  

#### Step [O6o9o6o1o0] 1.Overview

動画を見る  

* `Challenge 3 starter files` ユニティーパッケージを `Prototype 3` へインポートする

👇 2022年12月10日現在、このソースには `NullReferenceException` という例外がある不具合があるようで、以下のように修正する必要がある  

PlayerControllerX.cs:  

```csharp
    void Start()
    {
        // ...
        playerRb = GetComponent<Rigidbody>(); // 追加
        // ...
    }
```

#### Step [O6o9o6o2o0] 2.Warning

この章の説明を読むだけ  

#### Step [O6o9o6o3o0] 3.The player can’t control the balloon

* 「プレイヤーがスペースバーを押すと、風船が浮き上がるようにしてほしい」とのことだが、スペースバーを押すと浮き上がる。  
  ヒントを見てみると、 `NullReferenceException` を直せ、というチャレンジだったようだ。もう直した

#### Step [O6o9o6o4o0] 4.The background only moves when the game is over

* ゲームオーバーのとき背景が動くようになっている。これを、ゲーム開始時に背景が動き、ゲームオーバーのとき背景が止まるようにしてほしい
    * 条件判定の真偽が逆なのだろうと当たりを付けて、すぐ直す

#### Step [O6o9o6o5o0] 5.No objects are being spawned

* お金や爆弾といったゲームオブジェクトが画面上に生成されてこないので、数秒ごとに生成されてくるようにしてほしい
    * ゲームオブジェクトを生成するのは `SpawnManager` C#スクリプトだろうと当たりを付けて、すぐ直す

#### Step [O6o9o6o6o0] 6.Fireworks appear to the side of the balloon

* 「風船の近くに火花が現れているので、風船のところで火花が現れてほしい」ということだが、ゲーム画面を見ても　何が悪くて　どう直したらいいのか説明からは分からない
    * 爆発と　火花は　別のパーティクルのようだ
    * シーン ビューで、遠景にすると　遠くで火花が出ていることが分かった
        * ポジションの数値を直すだけでいいのか？

#### Step [O6o9o6o7o0] 7.The background is not repeating properly

* 背景のスクロールのリピートのつながりがおかしいから、つながりの切れ目が見えないように直してほしい
    * C#スクリプト全体を　にらめっこしてると　問題個所が分かる

#### Step [O6o9o6o8o0] 8.Bonus: The balloon can float way too high

* 風船が高く浮きすぎているから、高く浮きすぎないようにしてほしい
    * 風船が高く浮きすぎるのは、与える力が大きすぎるか、風船が軽すぎるか、それ以外かの理由だろうか？
        * 風船の軽さは、 `Player` ゲームオブジェクトの持つ `RigidBody` コンポーネントの `mass` で質量をキログラム単位で指定すればいいと思うが、風船は重いものではないだろう
        * 与える力は、 `Player` ゲームオブジェクトの持つ `PlayerControllerX` C#スクリプトの `floatForce` を指定すればいいと思う
            * じゃあ、バイナリーサーチでちょうどいい感じの数を探そうかと思ったが、風船が軽すぎるのか `floatForce` は 1 違うだけでだいぶ違う。少しずつ ずらして加減を調整する

#### Step [O6o9o6o9o0] 9.Bonus: The balloon can drop below the ground

📅 2022-12-10 sun 14:24  

* 風船が画面下の外へ落ちて行ってしまう。これを、画面下で跳ね返るようにしてほしい。跳ね返るとき効果音も付けてほしい
    * C#スクリプトを書けばいいのかもしれないが、チュートリアルのチャレンジ問題にしては手間が混み過ぎる。発想の問題。ヒントを見る
        * `PlayerController` C#スクリプトの `OnCollisionEnter()` メソッドを思い出す
        * `Ground` ゲームオブジェクトに、 `Ground` タグを付ける。 `Box Collider` コンポーネントも付ける

参考:  

```cs
        if (other.gameObject.CompareTag("Ground"))
        {
            // 接地
            // Debug.Log("Is ground!");
            playerRb.AddForce(Vector3.up * floatForceOnGround);
            playerAudio.PlayOneShot(boingSound, 1.0f);
        }
```

📺 [やってみた](https://twitter.com/muzudho1/status/1601446908249022465?s=20&t=C5dXIqh_LC3PXd5B10uImw)  

#### Step [O6o9o7o0] Lab 3 - Player Control

📅 2022-12-10 sun 14:54  

* `Lab 3 - Player Control` - Tutorial, Begginer, 1 Hour

* ほとんど復習

#### Step [O6o9o7o1o0] Overview Video

動画を見るだけ  

#### Step [O6o9o7o2o0] 1.Create PlayerController and plan your code

動画を見る  

* 基本操作の復習といった内容
    * `Unity Hub` から `Personal Project` プロジェクトを開く
    * `Player` ゲームオブジェクトへ `PlayerController` C#スクリプトをアタッチする

#### Step [O6o9o7o3o0] 2.Basic movement from user input

動画を見る  

* 説明がどんどん省略され始めてきている
* 十字キーを押したら、玉が転がるところの説明
    * `PlayerController` C#スクリプトの書き方の復習

#### Step [O6o9o7o4o0] 3.Constrain the Player’s movement

動画を見る  

* プレイヤーが転がらないように `Player` ゲームオブジェクトが持つ `Rigidbody` コンポーネントの `[Constraints] - [Freeze Rotation]` で制約を付ける
* 玉が画面外に転がりでないように、左右に壁を置くというもの
    * `Purple` 材質を追加、壁を紫色にする
* 玉が画面外に転がりでないように、上下に `PlayerController` C#スクリプトで制限するというもの

#### Step [O6o9o7o5o0] 4.Code Cleanup and Export Backup

動画を見る  

* `Environment` ゲームオブジェクトを作って、その下へ `Wall` ゲームオブジェクトを入れる、といった片づけ
* `Update()` メソッドの中の処理を、 `MovePlayer()` メソッドや `ConstrainPlayerPosition()` メソッドに分割するなどの、片づけ

#### Step [O6o9o7o6o0] 5.Lesson Recap

📅 2022-12-10 sun 17:39  

動画を見るだけ  

### Step [O6o9o8o0] Quiz 3

* `Quiz 3` - Quiz, Begginer, 15 Mins

概要は読まなくていいかも  

### Step [O6o9o9o0] Bonus Features 3 - Share your Work

📅 2022-12-10 sun 18:01  

* `Bonus Features 3 - Share your Work` - Tutorial, Begginer, 1 Hour

難しい課題に挑めるやつだ  

#### Step [O6o9o9o1o0] 1.Overview

完成図の動画を観る  

#### Step [O6o9o9o2o0] 2.Easy: Randomize obstacles

動画を観る  

* 柵だけでなく、積み上げた箱や、ドラム缶も生成しよう、というもの
    * 変数を配列に変える。インデックスの選択には乱数を使う

#### Step [O6o9o9o3o0] 3.Medium: Double jump

動画を観る  

* 2段ジャンプを実装しよう、というもの
* 2段ジャンプ中かどうかのフラグを付けたらいいのだろうか？ フラグ名は `isFirstJump` にしてみる

要点:  

```cs
        if (Input.GetKeyDown(KeyCode.Space) && (isOnGround || isFirstJump) && !gameOver)
        //                                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^
        {
            // ジャンプ
            isFirstJump = !isFirstJump;
            //            ^^^^^^^^^^^^
        }
```

#### Step [O6o9o9o4o0] 4.Hard: Dash ability and score

動画を観る  

* プレイヤーが特定のキーを押下している間、ダッシュするよう実装してほしい
    * 例えば `D` キーとか
    * フラグを使うか？ フラグ名は `isDash` とかにするか？
    * プレイヤーではなく、障害物と背景のスピードを変えなければいけないのが難しい
        * `MoveLeft` C#スクリプトの方に、 `PlayerController` C#スクリプトを参照するように変数を作ればいいのか？ と思ったら `gameOver` フィールドを見るために既に有った
        * `PlayerController` C#スクリプトに `speed` フィールドを追加するか？
* また、スコアを実装してほしい。ダッシュ中はスコアが２倍になる。ゲームオーバーでスコアのカウントアップを止める
    * スコアは単純な実装にする

MoveLeft.cs:  

```cs
        var speed = playerControllerScript.speed;

        if (playerControllerScript.gameOver == false)
        {
            transform.Translate(Vector3.left * Time.deltaTime * speed);
        }
```

PlayerController.cs:  

```cs
        if (Input.GetKeyDown(KeyCode.D) && isOnGround && !gameOver)
        {
            isDash = !isDash;

            if (isDash)
            {
                // ダッシュ
                Debug.Log("Dash!");
                speed = speedHigh;
                playerAnim.SetFloat("Speed_f", 2.0f);
            }
            else
            {
                // ダッシュを止める
                Debug.Log("Walk!");
                speed = speedNormal;
                playerAnim.SetFloat("Speed_f", 1.0f);
            }
        }

        if (isDash)
        {
            score += 2;
        }
        else
        {
            score++;
        }
```

📺 [やってみた](https://twitter.com/muzudho1/status/1601552521201299457?s=20&t=uqAbxnOnEh8FaF3s1zFwcg)  

#### Step [O6o9o9o5o0] 5.Expert: Game start animation

動画を観る  

* ゲーム開始直後から走っているが、これを、最初は背景が止まっていて、画面の外から歩いてきて、そして走る、というゲーム開始時の演出を付けてほしい
    * `SpawnManager` C#スクリプトの `Start()` メソッドで行っている、 `InvokeRepeating()` による繰り返し処理を遅らせた方がいいのか？
* ヒントを見る
    * `lerping` というのは、動作A, B の間を補完することを言うらしい
* 読者のコメントを見る
    * 愚直にやっているようだ。簡単にできないか？
    * とりあえず、イントロを 3秒 と固定して、プログラムを書いてみる
        * `MoveLeft` C#スクリプトと `SpawnManager` C#スクリプトを無効化したまま初めて、 3秒経過してから enable にする、といったことはできるか？
            * `GameManager` C#スクリプトを新規作成した方が楽そう
            * タイマーを作ったことはあっただろうか？

👇 チャレンジ２で、経過時間をカウントしていたことを思い出す  

```cs
    /// <summary>
    /// 経過時間
    /// </summary>
    private float elapsedSecs = float.MaxValue;
```

3 秒間かけて　画面外から　所定の位置へ歩いてくる、というのは　どうやって作る？  
TimeLine というものがあるらしいが使い方が分からない  

`Vector3.Lerp()` というメソッドもあるらしいが、よくわからない  

📖 [[Unity] Vector3.Lerpの使い方](https://qiita.com/aimy-07/items/ad0d99191da21c0adbc3)  

* ひとまず、プレイヤーの初期位置を　画面左端の外側になるよう、 `Ground` ゲームオブジェクトの左端に置く。 position x=-10 とする。重力で端から落ちないように気を付ける  
* `GameManager` C#スクリプトで、3秒経過したら、 position x=0 とする
* これだと、３秒後に瞬間移動するわけなので、その途中を補完するように見せたい
* 足元の土煙（パーティクル）は、 `enabled` ではなく、 `playOnAwake` チェックボックスのチェックを外して、あとで `Play()` で開始するようにする
    * 接地状態だと `Play()` してしまうので、アニメーション・ステートを確認する

👇 以下で、だいたい　うまくいった  

GameManager.cs:  

```cs
using UnityEngine;

public class GameManager : MonoBehaviour
{
    /// <summary>
    /// ゲーム開始時の演出時間（秒）
    /// </summary>
    public float introductionSecs = 2.0f;

    /// <summary>
    /// 経過時間（秒）
    /// </summary>
    private float elapsedSecs;

    private GameObject player;
    public ParticleSystem playerDirtSplatter; // 足元の土煙
    private GameObject background;
    private GameObject spawnManager;
    private Animator playerAnim;
    private bool isGameStart;
    private Vector3 preStartPos;
    private Vector3 startPos = new Vector3(0.0f, 0.0f, 0.0f);

    // Start is called before the first frame update
    void Start()
    {
        player = GameObject.Find("Player");
        background = GameObject.Find("Background");
        spawnManager = GameObject.Find("SpawnManager");
        playerAnim = player.GetComponent<Animator>();

        preStartPos = player.transform.position;
    }

    // Update is called once per frame
    void Update()
    {
        elapsedSecs += Time.deltaTime;

        if (!isGameStart)
        {
            // 中間補完
            player.transform.position = Vector3.Lerp(preStartPos, startPos, elapsedSecs / introductionSecs);

            // End
            if (elapsedSecs > introductionSecs)
            {
                // 演技
                playerAnim.SetFloat("Speed_f", 1.0f);   // 走るポーズ
                playerDirtSplatter.Play();  // 足元の土煙

                background.GetComponent<MoveLeft>().enabled = true;
                spawnManager.GetComponent<SpawnManager>().enabled = true;

                isGameStart = true;
            }
        }
    }
}
```

PlayerController.cs:  

```cs
    private void OnCollisionEnter(Collision collision)
    {
        if (collision.gameObject.CompareTag("Ground"))
        {
            // ...

            if (playerAnim.GetCurrentAnimatorStateInfo(0).IsName("Run_Static"))
            {
                dirtParticle.Play(); // 土煙
            }
        }// ...
    }
```

📺 [やってみた１](https://twitter.com/muzudho1/status/1601576570786746369?s=20&t=kGRKbSyu7KB1eHjYPYiY5Q)  
📺 [やってみた２](https://twitter.com/muzudho1/status/1601583986538532864?s=20&t=kGRKbSyu7KB1eHjYPYiY5Q)  

#### Step [O6o9o9o6o0] 6.Hints and solution walkthrough

📅 2022-12-10 sun 23:35  

読むだけ  

## Step [O6o10o0] Unit 4 - Introduction

📅 2022-12-10 sun 23:40  

* `Unit 4 - Introduction` - Tutorial, Begginer, 5 Min

📖 [Unit 4 - Introduction](https://learn.unity.com/tutorial/unit-4-introduction?uv=2021.3&projectId=5cf96846edbc2a2bcde6d0fc&courseId=5cf96c41edbc2a2ca6e8810f#)  

* このコース全体で、 Unit 4 が１番難しいとのこと

